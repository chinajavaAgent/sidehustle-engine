<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®ä¿¡åˆ†æåŠŸèƒ½æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .card { border: 1px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .btn { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .btn:hover { background: #0056b3; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .result { background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 10px 0; }
        .topic-item { border: 1px solid #eee; padding: 15px; margin: 10px 0; border-radius: 6px; }
        .keyword { background: #e3f2fd; padding: 2px 6px; border-radius: 3px; margin: 2px; display: inline-block; }
        .loading { color: #666; font-style: italic; }
        .error { color: #dc3545; background: #f8d7da; padding: 10px; border-radius: 4px; }
        .success { color: #155724; background: #d4edda; padding: 10px; border-radius: 4px; }
        textarea { width: 100%; min-height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª å¾®ä¿¡å…¬ä¼—å·æ™ºèƒ½åˆ†æåŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="card">
        <h2>ğŸ“± å¾®ä¿¡æ–‡ç« åˆ†æ</h2>
        <div>
            <label><strong>æ–‡ç« é“¾æ¥:</strong></label>
            <textarea id="urlInput" placeholder="è¯·è¾“å…¥å¾®ä¿¡å…¬ä¼—å·æ–‡ç« é“¾æ¥ï¼Œæ”¯æŒå¤šä¸ªï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰">https://mp.weixin.qq.com/s/LZgG-5uE8fGaJAiqb0FGYQ</textarea>
        </div>
        <div style="margin: 15px 0;">
            <label><strong>ç”Ÿæˆé€‰é¢˜æ•°é‡:</strong></label>
            <select id="limitSelect">
                <option value="5">5ä¸ª</option>
                <option value="10" selected>10ä¸ª</option>
                <option value="15">15ä¸ª</option>
            </select>
        </div>
        <div>
            <button class="btn" onclick="testWeChatAnalysis()" id="analyzeBtn">ğŸ” å¼€å§‹åˆ†æ</button>
            <button class="btn" onclick="testDemo()" id="demoBtn">ğŸ¬ æ¼”ç¤ºåŠŸèƒ½</button>
            <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ æ¸…ç©ºç»“æœ</button>
        </div>
    </div>

    <div class="card">
        <h2>ğŸ“Š æµ‹è¯•ç»“æœ</h2>
        <div id="results"></div>
    </div>

    <div class="card">
        <h2>ğŸ¯ ç”Ÿæˆçš„é€‰é¢˜</h2>
        <div id="topics"></div>
    </div>

    <script>
        let currentTest = '';

        function showLoading(message) {
            document.getElementById('results').innerHTML = `<div class="loading">â³ ${message}</div>`;
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('demoBtn').disabled = true;
        }

        function hideLoading() {
            document.getElementById('analyzeBtn').disabled = false;
            document.getElementById('demoBtn').disabled = false;
        }

        function showError(message) {
            document.getElementById('results').innerHTML = `<div class="error">âŒ ${message}</div>`;
            hideLoading();
        }

        function showSuccess(message) {
            const results = document.getElementById('results');
            results.innerHTML += `<div class="success">âœ… ${message}</div>`;
            hideLoading();
        }

        async function testWeChatAnalysis() {
            const urls = document.getElementById('urlInput').value
                .split('\\n')
                .map(url => url.trim())
                .filter(url => url && url.includes('mp.weixin.qq.com'));

            if (urls.length === 0) {
                showError('è¯·è¾“å…¥æœ‰æ•ˆçš„å¾®ä¿¡å…¬ä¼—å·æ–‡ç« é“¾æ¥');
                return;
            }

            const limit = parseInt(document.getElementById('limitSelect').value);
            
            showLoading(\`æ­£åœ¨åˆ†æ \${urls.length} ç¯‡æ–‡ç« ...\`);
            currentTest = 'wechat';

            try {
                // æ¨¡æ‹ŸAPIè°ƒç”¨ - å®é™…åº”è¯¥è°ƒç”¨ /api/topics/trending/wechat
                const mockResult = await simulateWeChatAnalysis(urls, limit);
                
                showSuccess(\`æˆåŠŸåˆ†æ \${urls.length} ç¯‡æ–‡ç« ï¼Œç”Ÿæˆ \${mockResult.length} ä¸ªé€‰é¢˜\`);
                displayTopics(mockResult);
                
            } catch (error) {
                showError(\`åˆ†æå¤±è´¥: \${error.message}\`);
            }
        }

        async function testDemo() {
            showLoading('æ­£åœ¨åŠ è½½æ¼”ç¤ºæ•°æ®...');
            currentTest = 'demo';

            try {
                // æ¨¡æ‹Ÿæ¼”ç¤ºæ•°æ®
                const demoResult = await simulateDemoData();
                
                showSuccess('æ¼”ç¤ºæ•°æ®åŠ è½½æˆåŠŸ');
                displayTopics(demoResult);
                
            } catch (error) {
                showError(\`æ¼”ç¤ºåŠ è½½å¤±è´¥: \${error.message}\`);
            }
        }

        async function simulateWeChatAnalysis(urls, limit) {
            // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // æ¨¡æ‹Ÿåˆ†æç»“æœï¼ˆåŸºäºå®é™…æµ‹è¯•æ•°æ®ï¼‰
            return [
                {
                    id: 1,
                    title: "å†…å®¹åˆ›ä½œæ–°è¶‹åŠ¿ï¼šæŠ„ä¹¦å˜ç°æŒ‡å—",
                    reason: "åŸºäº'ä¸€å¤©ä¸¤å°æ—¶ï¼Œæ”¶å…¥500+ï¼Œè¿™3ä¸ªæ­£è§„èµšé’±å¹³å°ï¼ŒçœŸçš„å¤ªé¦™äº†ï¼'åˆ†æç”Ÿæˆï¼Œæ—¶æ•ˆæ€§æŒ‡æ ‡å¾—åˆ†25ã€æ”¶ç›Šæ€§æŒ‡æ ‡å¾—åˆ†30ã€å®ç”¨æ€§æŒ‡æ ‡å¾—åˆ†15ï¼Œç»¼åˆçƒ­åº¦90åˆ†",
                    category: "å†…å®¹åˆ›ä½œ",
                    heat: 90,
                    keywords: ["æŠ„ä¹¦", "å‰ªè¾‘", "å¹³å°", "æ”¶å…¥", "å‰¯ä¸š"],
                    source_url: urls[0]
                },
                {
                    id: 2,
                    title: "2024å¹´æŠ„ä¹¦å‰¯ä¸šæœºä¼šæ·±åº¦è§£æ",
                    reason: "é€šè¿‡åˆ†æçƒ­é—¨å…¬ä¼—å·æ–‡ç« ï¼Œæå–å‰¯ä¸šæœºä¼šå’Œè¶‹åŠ¿",
                    category: "å†…å®¹åˆ›ä½œ", 
                    heat: 88,
                    keywords: ["2024", "æŠ„ä¹¦", "å‰¯ä¸š", "æœºä¼š", "åˆ†æ"],
                    source_url: urls[0]
                },
                {
                    id: 3,
                    title: "ä»é›¶å¼€å§‹åšå†…å®¹åˆ›ä½œï¼šæŠ„ä¹¦å®æˆ˜ç»éªŒ",
                    reason: "å®ç”¨æ€§æŒ‡æ ‡å¾—åˆ†é«˜ï¼Œé€‚åˆæ–°æ‰‹å…¥é—¨çš„å‰¯ä¸šæ–¹å‘",
                    category: "å†…å®¹åˆ›ä½œ",
                    heat: 85,
                    keywords: ["é›¶åŸºç¡€", "å†…å®¹åˆ›ä½œ", "å®æˆ˜", "ç»éªŒ"],
                    source_url: urls[0]
                }
            ].slice(0, limit);
        }

        async function simulateDemoData() {
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            return [
                {
                    id: 1,
                    title: "AIç»˜ç”»æ¥å•å®æˆ˜ï¼šæœˆå…¥è¿‡ä¸‡çš„å®Œæ•´æµç¨‹",
                    reason: "AIæŠ€æœ¯å‘å±•è¿…é€Ÿï¼Œå¸‚åœºéœ€æ±‚å¤§",
                    category: "AIå·¥å…·",
                    heat: 92,
                    keywords: ["AIç»˜ç”»", "Midjourney", "æ¥å•", "å˜ç°"],
                    source_url: "æ¼”ç¤ºæ•°æ®"
                },
                {
                    id: 2,
                    title: "å°çº¢ä¹¦ç§è‰æ–‡æ¡ˆå†™ä½œï¼šå•ç¯‡æ”¶è´¹200+",
                    reason: "å“ç‰Œè¥é”€éœ€æ±‚æŒç»­å¢é•¿ï¼Œç§è‰æ–‡æ¡ˆå¸‚åœºç«çƒ­",
                    category: "å†…å®¹åˆ›ä½œ",
                    heat: 88,
                    keywords: ["å°çº¢ä¹¦", "ç§è‰", "æ–‡æ¡ˆ", "è¥é”€"],
                    source_url: "æ¼”ç¤ºæ•°æ®"
                }
            ];
        }

        function displayTopics(topics) {
            const container = document.getElementById('topics');
            
            if (topics.length === 0) {
                container.innerHTML = '<div class="result">æš‚æ— ç”Ÿæˆçš„é€‰é¢˜</div>';
                return;
            }

            let html = '';
            topics.forEach((topic, index) => {
                html += \`
                    <div class="topic-item">
                        <h3>\${index + 1}. \${topic.title}</h3>
                        <div style="margin: 10px 0;">
                            <strong>æ¨èç†ç”±ï¼š</strong>\${topic.reason}
                        </div>
                        <div style="margin: 10px 0;">
                            <span style="background: #e3f2fd; padding: 4px 8px; border-radius: 4px; font-size: 12px;">\${topic.category}</span>
                            <span style="margin-left: 10px; color: #666;">çƒ­åº¦: \${topic.heat}åˆ†</span>
                        </div>
                        <div>
                            <strong>å…³é”®è¯ï¼š</strong>
                            \${topic.keywords.map(kw => \`<span class="keyword">\${kw}</span>\`).join('')}
                        </div>
                        \${topic.source_url && topic.source_url !== 'æ¼”ç¤ºæ•°æ®' ? \`
                            <div style="margin-top: 8px; font-size: 12px; color: #666;">
                                æ¥æº: \${topic.source_url.substring(0, 50)}...
                            </div>
                        \` : ''}
                    </div>
                \`;
            });
            
            container.innerHTML = html;
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('topics').innerHTML = '';
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ˜¾ç¤ºè¯´æ˜
        window.onload = function() {
            document.getElementById('results').innerHTML = \`
                <div class="result">
                    <h3>ğŸš€ åŠŸèƒ½è¯´æ˜</h3>
                    <p><strong>å¾®ä¿¡åˆ†æï¼š</strong>åŸºäºæ‚¨æä¾›çš„å¾®ä¿¡å…¬ä¼—å·æ–‡ç« é“¾æ¥ï¼Œæ™ºèƒ½æå–å…³é”®è¯å¹¶ç”Ÿæˆç›¸å…³é€‰é¢˜</p>
                    <p><strong>æ¼”ç¤ºåŠŸèƒ½ï¼š</strong>å±•ç¤ºç³»ç»Ÿçš„åˆ†æèƒ½åŠ›å’Œé€‰é¢˜ç”Ÿæˆæ•ˆæœ</p>
                    <p><strong>å®æµ‹æ–‡ç« ï¼š</strong>"ä¸€å¤©ä¸¤å°æ—¶ï¼Œæ”¶å…¥500+ï¼Œè¿™3ä¸ªæ­£è§„èµšé’±å¹³å°ï¼ŒçœŸçš„å¤ªé¦™äº†ï¼"</p>
                    <p><strong>æŠ€æœ¯ç‰¹è‰²ï¼š</strong>ä¸­æ–‡åˆ†è¯ + å…³é”®è¯æå– + ä¸»é¢˜åˆ†ç±» + çƒ­åº¦è¯„åˆ†</p>
                </div>
            \`;
        }
    </script>
</body>
</html>